<div style="display: flex; align-items: center; justify-content: center; padding: 12px; border: 1px solid #333; border-radius: var(--radius); background: #282a36; font-family: 'Courier New', Courier, monospace; font-size: 14px; margin-bottom: 30px; color: #f8f8f2;">
  <a href="https://buymeacoffee.com/nejc" target="_blank" rel="noopener noreferrer" style="display: inline-flex; align-items: center; gap: 10px; color: inherit; text-decoration: none;">
    <span style="color: #bd93f9; font-weight: bold;">$</span> 
    <span style="color: #f1fa8c;">sudo</span>
    <span>buy-coffee --user nejc</span>
    <span style="display: inline-block; width: 8px; height: 1.2em; background-color: #f8f8f2; vertical-align: middle; margin-left: 4px; animation: blink 1s step-end infinite;"></span>
  </a>
</div>

<style>
@keyframes blink {
  from, to { opacity: 1; }
  50% { opacity: 0; }
}
</style>

<script>
    // Helper to get current theme
    function getGiscusTheme() {
        const theme = localStorage.getItem("pref-theme");
        return theme === "dark" ? "dark" : "light";
    }

    // Set initial theme for Giscus
    document.write(`
        <script src="https://giscus.app/client.js"
                data-repo="nejckorasa/nejckorasa.github.io"
                data-repo-id="MDEwOlJlcG9zaXRvcnkyNzQ0NDI2MTE="
                data-category="Announcements"
                data-category-id="DIC_kwDOEFupc84CpfL-"
                data-mapping="pathname"
                data-strict="0"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-input-position="bottom"
                data-theme="${getGiscusTheme()}"
                data-lang="en"
                crossorigin="anonymous"
                async>
        <\/script>
    `);

    // Listen for theme toggle
    const toggle = document.getElementById("theme-toggle");
    if (toggle) {
        toggle.addEventListener("click", () => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (!iframe) return;
            
            // Toggle logic mimics the theme's logic: if currently dark, it becomes light, etc.
            // But since we run AFTER the theme's click handler, we need to check the NEW state.
            // A clearer way is to check the HTML attribute after a microtask.
            
            setTimeout(() => {
                const currentTheme = document.body.className.includes("dark") || document.querySelector("html").dataset.theme === "dark" ? "dark" : "light";
                const newGiscusTheme = currentTheme === "dark" ? "dark" : "light";
                
                iframe.contentWindow.postMessage({
                    giscus: {
                        setConfig: {
                            theme: newGiscusTheme
                        }
                    }
                }, 'https://giscus.app');
            }, 100);
        });
    }
</script>